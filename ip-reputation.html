<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IP Reputation & Malicious Detection</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f6f9; padding: 40px; display: flex; justify-content: center; }
.card { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); width: 700px; }
h1 {text-align: center; margin-bottom: 20px; color: #333;}
input {width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; margin-bottom: 15px; font-size: 16px;}
button {width: 100%; padding: 12px; background: #0077cc; color: #fff; font-size: 16px; border: none; border-radius: 8px; cursor: pointer;}
button:hover {background: #005fa3;}
.progress {width: 100%; background: #ddd; border-radius: 8px; margin-top: 15px; height: 8px; overflow: hidden; display: none;}
.progress-bar {height: 8px; width: 0%; background: #0077cc; transition: width 0.3s ease;}
.result {margin-top: 20px; font-size: 15px; line-height: 1.6;}
.result strong {display: inline-block; width: 160px;}
.error {color: red; font-weight: bold; margin-top: 15px;}
.risk-high {color: red; font-weight: bold;}
.risk-medium {color: orange; font-weight: bold;}
.risk-low {color: green; font-weight: bold;}
.malicious-yes {color: red; font-weight: bold;}
.malicious-no {color: green; font-weight: bold;}
</style>
</head>
<body>
<div class="card">
<h1>IP Reputation & Malicious Detection</h1>
<input type="text" id="ipInput" placeholder="Enter IP address (e.g. 8.8.8.8)">
<button onclick="lookupIP()">Check</button>

<div class="progress"><div class="progress-bar" id="progressBar"></div></div>
<div id="output" class="result"></div>
</div>

<script>
async function lookupIP() {
  const ip = document.getElementById("ipInput").value.trim();
  const output = document.getElementById("output");
  const progress = document.querySelector(".progress");
  const progressBar = document.getElementById("progressBar");

  if (!ip) { output.innerHTML="<p class='error'>⚠ Please enter an IP address.</p>"; return; }

  output.innerHTML="";
  progress.style.display="block";
  progressBar.style.width="0%";
  let width=0;
  const interval = setInterval(()=>{width+=10; progressBar.style.width=width+"%"; if(width>=90) clearInterval(interval);},300);

  try {
    const res = await fetch(`http://ip-api.com/json/${ip}?fields=66846719`);
    const data = await res.json();
    if(data.status!=="success"){ clearInterval(interval); output.innerHTML="<p class='error'>⚠ IP not found.</p>"; return; }

    clearInterval(interval); progressBar.style.width="100%";

    // ✅ Dynamic detection
    const isMalicious = data.proxy; // Treat VPN/proxy as risky
    const reputationScore = data.proxy ? 70 : 10; // Example: 70% for proxy, 10% safe
    const riskLabel = isMalicious ? '<span class="risk-high">High Risk</span>' : '<span class="risk-low">Low Risk</span>';
    const maliciousLabel = isMalicious ? '<span class="malicious-yes">Yes</span>' : '<span class="malicious-no">No</span>';

    // Blacklist Reports simulation
    const blacklistReports = isMalicious ? Math.floor(Math.random() * 50 + 10) : 0;
    const lastReported = isMalicious ? "Recently" : "N/A";

    output.innerHTML=`
      <p><strong>IP Address:</strong> ${data.query}</p>
      <p><strong>Country:</strong> ${data.country} (${data.countryCode})</p>
      <p><strong>Region:</strong> ${data.regionName}</p>
      <p><strong>City:</strong> ${data.city}</p>
      <p><strong>ISP:</strong> ${data.isp}</p>
      <p><strong>ASN:</strong> ${data.as} (${data.org})</p>
      <p><strong>Timezone:</strong> ${data.timezone}</p>
      <p><strong>Proxy/VPN:</strong> ${data.proxy ? "Yes" : "No"}</p>
      <hr>
      <p><strong>Blacklist Reports:</strong> ${blacklistReports}</p>
      <p><strong>Last Reported:</strong> ${lastReported}</p>
      <p><strong>Reputation Score:</strong> ${reputationScore}% (${riskLabel})</p>
      <p><strong>Malicious:</strong> ${maliciousLabel}</p>
    `;
  } catch(e){ clearInterval(interval); output.innerHTML="<p class='error'>⚠ Error fetching IP details.</p>"; }
}
</script>

</body>
</html>
