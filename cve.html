<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>CVE Search Tool</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="cve.css" />
</head>

<body>
  <header class="header">
    <div class="container">
      <div class="header__wrapper">
        <div class="c-logo">
          <a href="index.html">
            <img src="img/logo.png" alt="Logo" class="c-logo__img" />
          </a>

          <span class="c-logo__text c-logo__text--white"></span>
        </div>
        </a>
        <nav class="c-nav">
          <button class="c-nav__toggle" id="navToggle" aria-label="Toggle navigation">
            <span class="c-nav__bar"></span>
            <span class="c-nav__bar"></span>
            <span class="c-nav__bar"></span>
          </button>

          <div class="c-nav__content">
            <ul class="c-list c-list--flex">
              <li class="c-list__item">
                <a href="pricing.html" class="c-link c-link--list">Pricing</a>
              </li>
              <li class="c-list__item">
                <a href="index.html#section-services" class="c-link c-link--list">Services</a>
              </li>
              <li class="c-list__item">
                <a href="about.html" class="c-link c-link--list">About</a>
              </li>
              <li class="c-list__item">
                <a href="features.html" class="c-link c-link--list">Features</a>
              </li>
              <li class="c-list__item">
                <a href="agents.html" class="c-link c-link--list">CloFix Agent</a>
              </li>
              <li class="c-list__item">
                <a href="contact.html" class="c-link c-link--list">Contact</a>
              </li>
            </ul>
            <a href="ticket.html" class="ticket-button">
              <button class="c-button c-button--small c-button--secondary">
                Create Ticket
              </button>
            </a>
          </div>
        </nav>
      </div>
    </div>
  </header>

  <div class="cve-intro">
    <div class="container">
      <h1 class="cve-title">Revolutionary AI-Powered<br>Security Intelligence</h1>
      <p class="cve-subtext">
        Welcome to the CVE Search Tool. Use this tool to quickly find CVE IDs or explore vulnerabilities with ease.
      </p>
    </div>
  </div>


  <main class="dve">
    <div class="container">
      <h2>üîé CVE Search Tool</h2>
      <div class="search-box">
        <input type="text" id="cveInput" placeholder="Enter CVE ID or Keyword (e.g. CVE-2023-23397 or Windows Outlook)">
        <button onclick="lookupCVE()">Search</button>
      </div>

      <!-- Progress bar -->
      <div class="progress" id="progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div id="output"></div>
    </div>
  </main>
  <footer class="footer">

    <div class="stars"></div>
    <div class="stars2"></div>
    <div class="stars3"></div>

    <div class="container c-footer">
      <div class="c-footer__column c-footer__logo-column">
        <a href="#" class="c-footer__brand">
          <img src="img/logo.png" alt="CloFix Logo" class="c-footer__logo" />
        </a>
        <p class="c-footer__text">
          <strong>Secure. Automate. Scale</strong>
        </p>
        <ul class="social">
          <li class="social-li">
            <a href="https://www.facebook.com/share/1CjDhd7WfX/" target="_blank">
              <img src="img/facebook_clofix.png" alt="Facebook" />
            </a>
          </li>
          <li class="social-li">
            <a href="https://x.com/clofix19" target="_blank">
              <img src="img/X_clofix.png" alt="X" />
            </a>
          </li>
          <li class="social-li">
            <a href="https://www.linkedin.com/company/clofix/" target="_blank">
              <img src="img/linkedin_clofix.png" alt="LinkedIn" />
            </a>
          </li>
          <li class="social-li">
            <a href="https://wa.me/8801850603126" target="_blank">
              <img src="img/whatsapp_clofix.png" alt="WhatsApp" />
            </a>
          </li>
        </ul>

      </div>

      <div class="c-footer__column">
        <h4 class="c-footer__subtitle">Company</h4>
        <ul class="c-footer__list c-footer__list--check">
          <li><a href="about.html">About CloFix</a></li>
          <li><a href="contact.html">Contact CloFix</a></li>
          <li><a href="#">Documentation</a></li>
          <li><a href="support.html">CloFix WAF Support Overview</a></li>
        </ul>
      </div>

      <div class="c-footer__column">
        <h4 class="c-footer__subtitle">Explore</h4>
        <ul class="c-footer__list c-footer__list--check">
          <li><a href="#">Events</a></li>
          <li><a href="release.html">Release</a></li>
          <li><a href="partner.html">Become A Partner</a></li>
          <li><a href="blogs.html">Blogs</a></li>
        </ul>
      </div>

      <div class="c-footer__column">
        <h4 class="c-footer__subtitle">Legal</h4>
        <ul class="c-footer__list c-footer__list--check">
          <li><a href="terms.html">Terms and Conditions</a></li>
        </ul>
      </div>
    </div>

    <div class="container">
      <p class="footer__text">¬© 2025 ¬© Clofix ‚Äì Copyright All Rights Reserved</p>
    </div>
  </footer>

  <script>
    let currentPage = 0;
    let currentResults = [];

    function lookupCVE(page = 0) {
      const query = document.getElementById("cveInput").value.trim();
      const output = document.getElementById("output");
      const progress = document.getElementById("progress");
      const progressBar = document.getElementById("progressBar");
      output.innerHTML = "";
      currentResults = [];

      if (!query) {
        output.innerHTML = '<p class="error">‚ö† Please enter a CVE ID or keyword.</p>';
        return;
      }

      // Show progress bar
      progress.style.display = "block";
      progressBar.style.width = "0%";

      let width = 0;
      const loading = setInterval(() => {
        if (width >= 90) {
          clearInterval(loading);
        } else {
          width += 10;
          progressBar.style.width = width + "%";
        }
      }, 300);

      // Detect if it's a CVE ID
      let apiUrl = query.match(/^CVE-\d{4}-\d+$/i)
        ? `https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=${query}`
        : `https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=${encodeURIComponent(query)}&startIndex=${page * 10}&resultsPerPage=10`;

      fetch(apiUrl)
        .then(res => res.json())
        .then(data => {
          clearInterval(loading);
          progressBar.style.width = "100%";
          setTimeout(() => { progress.style.display = "none"; }, 500);

          if (!data.vulnerabilities || data.vulnerabilities.length === 0) {
            output.innerHTML = '<p class="error">‚ùå No results found.</p>';
            return;
          }

          currentResults = data.vulnerabilities;

          // Single CVE
          if (query.match(/^CVE-\d{4}-\d+$/i)) {
            renderDetails(currentResults[0].cve, output);
          } else {
            renderList(currentResults, output, page, data.totalResults || 0);
          }
        })
        .catch(() => {
          clearInterval(loading);
          progress.style.display = "none";
          output.innerHTML = '<p class="error">‚ö† Error fetching CVE details.</p>';
        });
    }

    function renderDetails(cve, output) {
      const metrics = cve.metrics?.cvssMetricV31?.[0] || cve.metrics?.cvssMetricV30?.[0] || cve.metrics?.cvssMetricV2?.[0];
      const severity = metrics ? `<span class="severity ${metrics.cvssData.baseSeverity}">${metrics.cvssData.baseSeverity}</span>` : "N/A";

      output.innerHTML = `
        <table>
          <tr><th>CVE ID</th><td>${cve.id}</td></tr>
          <tr><th>Published</th><td>${cve.published}</td></tr>
          <tr><th>Last Modified</th><td>${cve.lastModified}</td></tr>
          <tr><th>Description</th><td>${cve.descriptions[0].value}</td></tr>
          <tr><th>Severity</th><td>${severity}</td></tr>
          <tr><th>CVSS Score</th><td>${metrics ? metrics.cvssData.baseScore : "N/A"}</td></tr>
          <tr><th>Vector</th><td>${metrics ? metrics.cvssData.vectorString : "N/A"}</td></tr>
          <tr><th>Source</th><td>
            <a href="https://nvd.nist.gov/vuln/detail/${cve.id}" target="_blank">NVD</a> | 
            <a href="https://www.exploit-db.com/search?cve=${cve.id}" target="_blank">Exploit DB</a>
          </td></tr>
        </table>
      `;
    }

    function renderList(results, output, page, total) {
      let html = `
        <table>
          <tr><th>CVE ID</th><th>Description</th><th>Severity</th><th>Score</th></tr>
      `;

      results.forEach(v => {
        const cve = v.cve;
        const metrics = cve.metrics?.cvssMetricV31?.[0] || cve.metrics?.cvssMetricV30?.[0] || cve.metrics?.cvssMetricV2?.[0];
        const severity = metrics ? `<span class="severity ${metrics.cvssData.baseSeverity}">${metrics.cvssData.baseSeverity}</span>` : "N/A";
        const score = metrics ? metrics.cvssData.baseScore : "N/A";

        html += `
          <tr>
            <td><a href="#" onclick="renderDetails(${JSON.stringify(cve).replace(/"/g, '&quot;')}, document.getElementById('output'))">${cve.id}</a></td>
            <td>${cve.descriptions[0].value.substring(0, 80)}...</td>
            <td>${severity}</td>
            <td>${score}</td>
          </tr>
        `;
      });

      html += "</table>";

      // Pagination
      const totalPages = Math.ceil(total / 10);
      if (totalPages > 1) {
        html += `<div class="pager">`;
        if (page > 0) html += `<button onclick="lookupCVE(${page - 1})">‚¨Ö Prev</button>`;
        html += `<span> Page ${page + 1} of ${totalPages} </span>`;
        if (page < totalPages - 1) html += `<button onclick="lookupCVE(${page + 1})">Next ‚û°</button>`;
        html += `</div>`;
      }

      output.innerHTML = html;
    }
  </script>
</body>

</html>